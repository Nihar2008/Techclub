import speech_recognition as speech
import pyttsx3
import datetime
now = datetime.datetime.now()
import pyjokes
import time
import pywhatkit
import wikipedia
import playsound
import webbrowser

engine=pyttsx3.init()

engine.setProperty("RATE",175)

engine.say("Allow me to introduce myself!")
engine.say("I am JARVIS the virtual artificial intelligence assistant. And I am here to assist you with tasks as best as I can.")
engine.runAndWait()
time.sleep(1)
engine.say("I am here for you 24 hours a day, 7 days a week")
engine.runAndWait()
engine.say("Initializing startup sequence.")
engine.runAndWait()
from playsound import playsound
playsound('A.mp3')
engine.say("The system is now fully operational.")
engine.runAndWait()


engine.runAndWait()


while True:
    try:
        #Take the user input to activate reception of Voice Commands
        userInput=input("Press v to start voice commands and q to quit: ")
        
        if userInput=='v':
            
            #Take Voice commands from mic
            r=speech.Recognizer()
            with speech.Microphone() as source:
                r.adjust_for_ambient_noise(source)
                print("Speak:")
                audio=r.listen(source)
            #Convert Voice Commands to Text
            command=r.recognize_google(audio)
            
            if "wake" in command :
                    engine.say("Up and ready for you sir!")
                    engine.runAndWait()
                    
            
            if "time" in command:
                    engine.say("The time is:")
                    engine.runAndWait()
                    engine.say(now.strftime("%H:%M:%S"))
                    engine.runAndWait()
                    
            if "joke" in command :
                    engine.say("Here it is!")
                    engine.runAndWait()
                    engine.say(pyjokes.get_joke())
                    engine.runAndWait()
                    engine.say("ha ha ha")
                    engine.runAndWait()

            if 'play' in command:
                    song = command.replace('play', '')
                    engine.say('playing ' + song)
                    engine.runAndWait()
                    pywhatkit.playonyt(song)
                
            if 'who is' in command :
                    person = command.replace('who is', '')
                    info = wikipedia.summary(person, 1)
                    print(info)
                    engine.say(info)
                    engine.runAndWait()
                
            if 'what is' in command :
                    person = command.replace('what is', '')
                    info = wikipedia.summary(person, 1)
                    print(info)
                    engine.say(info)
                    engine.runAndWait()
            
            if 'fact' in command :
                    engine.say("A very astute observation sir. We should improve the space travel from our planet.")
                    engine.runAndWait()
                    
            if 'ready' in command :
                    engine.say("For you sir? Always!")
                    engine.runAndWait()
                    
            if 'unwell' in command :
                    engine.say("Here are some clinics nearby:-")
                    engine.say("Hope you get well soon.")
                    webbrowser.open('https://www.google.com/search?q=doctors+near+me&source=hp&ei=THSeYOO_Ho30rAGViIroCQ&iflsig=AINFCbYAAAAAYJ6CXLqdEvZ0JRSnqM4yfkhgRXP0PODb&oq=doctors+near&gs_lcp=Cgdnd3Mtd2l6EAEYADIICAAQsQMQyQMyBQgAEJIDMgIIADICCAAyAggAMgIIADICCAAyAggAMgIIADICCAA6CAgAELEDEIMBOgUIABCxAzoLCC4QsQMQxwEQowI6CAguELEDEIMBOggILhDHARCjAjoFCC4QsQM6AgguOggILhDHARCvAToECAAQClD1BVjhG2DJMGgAcAB4AIAB1gGIAZ0MkgEGMC4xMS4xmAEAoAEBqgEHZ3dzLXdpeg&sclient=gws-wiz')
                    
            if 'make some music' in command :
                    engine.say("Not really professional at it sir. I'll still try")
                    engine.runAndWait()
                    from playsound import playsound
                    playsound('B.mp3')
                    engine.say("How do you think it was?")
                    engine.runAndWait()
                    
            if 'nice' in command :
                    engine.say("Thank you very much for your compliment!")
                    engine.runAndWait()
                
        else:
            break
   
    #Statements to Handle errors while receiving voice commands
    except speech.UnknownValueError:
        print("Could not understand audio")
    except speech.RequestError as e:
        print("Could not request results; {0}".format(e))
    except KeyboardInterrupt:
        break
engine.say("Nice interacting with you sir.")
engine.runAndWait()
print("Nice interacting with you!!")
